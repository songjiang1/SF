
<!doctype html>
<html style="height:100%;font-size:14px;">
<head>
    <meta name="spreadjs culture" content="zh-cn" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="http://cdn.grapecity.com/spreadjs/hosted/css/gc.spread.sheets.excel2013white.12.1.0.css">
    <script src="http://code.jquery.com/jquery-1.8.2.min.js" type="text/javascript"></script>
    <script src="http://cdn.grapecity.com/spreadjs/hosted/scripts/gc.spread.sheets.all.12.1.0.min.js" type="text/javascript"></script>
    <script src="http://cdn.grapecity.com/spreadjs/hosted/scripts/resources/zh/gc.spread.sheets.resources.zh.12.1.0.min.js" type="text/javascript"></script>
    <style>
        * {
            -webkit-tap-highlight-color: rgba(0,0,0,0);
        }

        .sample-tutorial {
            position: relative;
            height: 100%;
            overflow: hidden;
        }

        .sample-spreadsheets {
            width: calc(100% - 280px);
            height: 100%;
            overflow: hidden;
            float: left;
        }

        .options-container {
            float: right;
            width: 280px;
            padding: 12px;
            height: 100%;
            box-sizing: border-box;
            background: #fbfbfb;
            overflow: auto;
        }

        .option-row {
            font-size: 14px;
            padding: 5px;
            margin-top: 10px;
        }

        label {
            display: block;
            margin-bottom: 6px;
        }

        input {
            padding: 4px 6px;
        }

            input[type=button] {
                margin-top: 6px;
                display: block;
            }
    </style>
</head>
<body style="margin:0;position:absolute;top:0;bottom:0;left:0;right:0;font-size:14px;user-select:none;-webkit-user-select: none;overflow:hidden;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'">
    <div class="sample-tutorial">
        <div id="ss" class="sample-spreadsheets"></div>
        <div class="options-container">
            <div class="option-row">
                <label style="background-color:lavender;">Select one of the gray cells to get its binding path</label>
            </div>
            <div class="option-row">
                <label>GetBindingPath:&nbsp;&nbsp;</label>
                <label id="bindingPath" style="color:darkgreen"></label>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        window.onload = function () {
            var spread = new GC.Spread.Sheets.Workbook(document.getElementById("ss"));
            initSpread(spread);
        };

        function initSpread(spread) {
            var spreadNS = GC.Spread.Sheets;

            var sheet = spread.sheets[0];
            sheet.suspendPaint();
            sheet.setColumnWidth(0, 120);
            sheet.setColumnWidth(1, 120);
            sheet.setColumnWidth(2, 120);
            sheet.setValue(0, 0, 'cell-binding');
            sheet.setValue(2, 1, 'name');
            sheet.setValue(3, 1, 'age');
            sheet.setValue(4, 1, 'sex');
            sheet.setValue(5, 1, 'address.postcode');

            var person = {
                name: "Wang feng",
                age: 25,
                sex: "male",
                address: {
                    postcode: "710075"
                }
            };
            var source = new spreadNS.Bindings.CellBindingSource(person);
            sheet.setBindingPath(2, 2, "name");
            sheet.setBindingPath(3, 2, "age");
            sheet.setBindingPath(4, 2, "sex");
            sheet.setBindingPath(5, 2, "address.postcode");
            sheet.setDataSource(source);
            sheet.setSelection(2, 2, 1, 1);
            var path = sheet.getBindingPath(2, 2);
            sheet.getRange(2, 2, 4, 1).backColor("rgb(208,206,206)");
            document.getElementById("bindingPath").innerHTML = path || "";
            sheet.bind(spreadNS.Events.SelectionChanged, function () {
                var activeCell = sheet.getSelections()[0];
                var path = sheet.getBindingPath(activeCell.row, activeCell.col);
                document.getElementById("bindingPath").innerHTML = path || "";
            });
            sheet.resumePaint();

        };
    </script>
</body>
</html>